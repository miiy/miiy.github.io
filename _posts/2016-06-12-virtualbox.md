---
layout: post
title: "VirtualBox"
date: 2016-06-12
category: linux
tags: linux virtualbox
---


###配置网络信息

网络设置
桥接
```
vim /etc/sysconfig/network-scripts/ifcfg-enp0s3
```

```
TYPE=Ethernet
BOOTPROTO=static
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_PEERDNS=yes
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
NAME=enp0s3
UUID=3ea53367-7428-4db7-98a7-5782a661cba6
DEVICE=enp0s3
ONBOOT=yes
IPADDR=192.168.31.200
NETMASK=255.255.255.0
GATEWAY=192.168.31.1
```


```
vim /etc/resolv.conf
```

```
# Generated by NetworkManager


# No nameservers found; try putting DNS servers into your
# ifcfg files in /etc/sysconfig/network-scripts like so:
#
# DNS1=xxx.xxx.xxx.xxx
# DNS2=xxx.xxx.xxx.xxx
# DOMAIN=lab.foo.com bar.foo.com
nameserver 8.8.8.8
nameserver 114.114.114.114
```

```
vim /etc/sysconfig/network-scripts/ifcfg-en** #修改网卡信息 ONBOOT=yes
systemctl restart network.service #重启网络
ping www.baidu.com #测试网络是否正常
```
###关闭firewall

```
systemctl stop firewalld.service #停止firewall
systemctl disable firewalld.service #禁止firewall开机启动
```

###安装iptables

```
yum install iptables-services #安装iptables
vi /etc/sysconfig/iptables #配置iptables增加21,80,3306等所需要的端口
```

配置信息：

```
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT
```

```
systemctl restart iptables.service #重启防火墙使配置生效
systemctl enable iptables.service #设置防火墙开机启动
```

###查看ip

```
ip addr #查看IP
```

###关闭SELINUX

```
sestatus #查看状态
vi /etc/selinux/config #将SELINU改为disabled 修改完成后保存重启，再次查看状态
```



###下载软件包

1、下载nginx

`http://nginx.org/download/nginx-1.8.0.tar.gz`

2、下载MySQL

`http://cdn.mysql.com/archives/mysql-5.6/mysql-5.6.24.tar.gz`

3、下载php

`http://cn2.php.net/distributions/php-5.6.12.tar.gz`

4、下载pcre （支持nginx伪静态）

`ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.37.tar.gz`

5、下载openssl（nginx扩展）

`http://www.openssl.org/source/openssl-1.0.2d.tar.gz`

6、下载zlib（nginx扩展）

`http://zlib.net/zlib-1.2.8.tar.gz`

7、下载cmake（MySQL编译工具）

`http://www.cmake.org/files/v3.3/cmake-3.3.1.tar.gz`

8、下载libmcrypt（php扩展）

`http://nchc.dl.sourceforge.net/project/mcrypt/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz`

9、下载yasm（php扩展）

`http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz`

10、t1lib（php扩展）

`ftp://sunsite.unc.edu/pub/Linux/libs/graphics/t1lib-5.1.2.tar.gz`

11、下载gd库安装包

`https://bitbucket.org/libgd/gd-libgd/downloads/libgd-2.1.1.tar.gz`

12、libvpx（gd库需要）

`http://storage.googleapis.com/downloads.webmproject.org/releases/webm/libvpx-1.4.0.tar.bz2`

13、tiff（gd库需要）

`http://download.osgeo.org/libtiff/tiff-4.0.3.tar.gz`

14、libpng（gd库需要）

`ftp://ftp.simplesystems.org/pub/png/src/libpng16/libpng-1.6.18.tar.gz`

15、freetype（gd库需要）

`http://ring.u-toyama.ac.jp/archives/graphics/freetype/freetype2/freetype-2.6.tar.gz`

16、jpegsrc（gd库需要）

`http://www.ijg.org/files/jpegsrc.v9a.tar.gz`

以上软件包上传到`/usr/local/src`目录


###安装编译工具及库文件（使用yum命令安装）

```
yum install -y apr* autoconf automake bison bzip2 bzip2* cloog-ppl compat* cpp curl curl-devel fontconfig fontconfig-devel freetype freetype* freetype-devel gcc gcc-c++ gtk+-devel gd gettext gettext-devel glibc kernel kernel-headers keyutils keyutils-libs-devel krb5-devel libcom_err-devel libpng libpng-devel libjpeg* libsepol-devel libselinux-devel libstdc++-devel libtool* libgomp libxml2 libxml2-devel libXpm* libtiff libtiff* make mpfr ncurses* ntp openssl openssl-devel patch pcre-devel perl php-common php-gd policycoreutils telnet t1lib t1lib* nasm nasm* wget zlib-devel
```

###安装MySQL
1、安装cmake

```
cd /usr/local/src
tar zxvf cmake-3.3.1.tar.gz
cd cmake-3.3.1
./configure
make
make install
```
2、安装MySQL
```
groupadd mysql #添加mysql组
useradd -g mysql mysql -s /bin/false #创建用户mysql并加入到mysql组，不允许mysql用户直接登录系统
mkdir -p /data/mysql #创建MySQL数据库存放目录
chown -R mysql:mysql /data/mysql #设置MySQL数据库存放目录权限
mkdir -p /usr/local/mysql #创建MySQL安装目录
cd /usr/local/src #进入软件包存放目录
zxvf mysql-5.6.24.tar.gz #解压
cd mysql-5.6.24 #进入目录
cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/data/mysql -DSYSCONFDIR=/etc #配置
make #编译
make install #安装
rm -rf /etc/my.cnf #删除系统默认的配置文件（如果默认没有就不用删除）
cd /usr/local/mysql #进入MySQL安装目录
./scripts/mysql_install_db --user=mysql --basedir=/usr/local/mysql --datadir=/data/mysql #生成mysql系统数据库
ln -s /usr/local/mysql/my.cnf /etc/my.cnf #添加到/etc目录的软连接
cp ./support-files/mysql.server /etc/rc.d/init.d/mysqld #把Mysql加入系统启动
chmod 755 /etc/init.d/mysqld #增加执行权限
chkconfig mysqld on #加入开机启动
vi /etc/rc.d/init.d/mysqld #编辑
basedir=/usr/local/mysql #MySQL程序安装路径
datadir=/data/mysql #MySQl数据库存放目录
:wq! #保存退出
service mysqld start #启动
vi /etc/profile #把mysql服务加入系统环境变量：在最后添加下面这一行
export PATH=$PATH:/usr/local/mysql/bin
:wq! #保存退出
source /etc/profile  #使配置立刻生效
下面这两行把myslq的库文件链接到系统默认的位置，这样你在编译类似PHP等软件时可以不用指定mysql的库文件地址。
ln -s /usr/local/mysql/lib/mysql /usr/lib/mysql
ln -s /usr/local/mysql/include/mysql /usr/include/mysql
mkdir /var/lib/mysql #创建目录
ln -s /tmp/mysql.sock /var/lib/mysql/mysql.sock #添加软链接
mysql_secure_installation #设置Mysql密码，根据提示按Y 回车输入2次密码
```
###安装Nginx
1、安装pcre
```
cd /usr/local/src
mkdir /usr/local/pcre
tar zxvf pcre-8.37.tar.gz
cd pcre-8.37
./configure --prefix=/usr/local/pcre
make
make install
```
2、安装openssl
```
cd /usr/local/src
mkdir /usr/local/openssl
tar zxvf openssl-1.0.2d.tar.gz
cd openssl-1.0.2d
./config --prefix=/usr/local/openssl
make
make install
vi /etc/profile
export PATH=$PATH:/usr/local/openssl/bin
:wq!
source /etc/profile
```
3、安装zlib
```
cd /usr/local/src
mkdir /usr/local/zlib
tar zxvf zlib-1.2.8.tar.gz

```

