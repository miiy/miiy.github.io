---
layout: post
title: "Jenkins"
date: 2020-12-12
tags: jenkins
---

## 使用 docker 启动 jenkins

https://www.jenkins.io/doc/book/installing/docker/

```bash
sudo docker run -u root --name jenkins -d \
    --restart always \
    --add-host gitlab.k8s:10.0.2.20 \
    --add-host harbor.k8s:10.0.2.20 \
    -p 8082:8080 \
    -p 50000:50000 \
    -v /data/jenkins/jenkins_home:/var/jenkins_home \
    jenkins/jenkins
```

## gitlab 设置

打开 Admin Area >> Settings >> Network >> Outbound requests

勾选

```text
[v] Allow requests to the local network from web hooks and services
```

允许 web hooks and service 请求本地网络


项目 >> Settings >> Webhooks


## 配置 jenkins

安装 Docker plugin, GitLab Plugin, SSH Agent 插件


### 配置 docker

系统配置 >> 节点管理 >> 云

添加 docker

```text
Docker Host URI: tcp://10.0.2.20:2375
```

点击 Test Connection
