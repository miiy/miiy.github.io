---
layout: post
title: "Redis"
date: 2016-06-13
tags: redis
---

## Docker

```bash
docker run --name redis -d --restart=always \
  -v /srv/docker/redis/data:/data \
  --net backend -d redis:7.2.6 \
  redis-server --save 60 1 --loglevel warning
```

```bash
docker run --name redis -d --restart=always \
  -p 127.0.0.1:6379:6379 \
  -v /srv/docker/redis/conf:/usr/local/etc/redis \
  -v /srv/docker/redis/data:/data \
  --net backend -d redis:7.2.6 \
  redis-server /usr/local/etc/redis/redis.conf
```

redis-cli

```bash
docker run -it --network backend --rm redis:7 redis-cli -h [IP]
```

## Install

```bash
cd /usr/local/src
wget https://download.redis.io/releases/redis-6.2.0.tar.gz
tar -zxvf redis-6.2.0.tar.gz redis-6.2.0/
mv redis-6.2.0 /usr/local/
cd /usr/local/
ln -s redis-6.2.0/ redis
make
make PREFIX=/usr/local/redis install
```

## 开机启动

```bash
cd /usr/local/src/redis-4.0.2
mkdir /etc/redis
cp redis.conf /etc/redis/6379.conf
sed -i 's/^daemonize no/daemonize yes/' /etc/redis/6379.conf
sed -i 's/^dir .\//dir \/var\/lib\/redis/' /etc/redis/6379.conf
sed -i 's/^appendonly no/appendonly yes/' /etc/redis/6379.conf
mkdir -p /var/lib/redis
cp utils/redis_init_script /etc/rc.d/init.d/redisd
chmod +x /etc/rc.d/init.d/redisd
sed -i '5i# chkconfig: 2345 90 10\n# description: Redis is a persistent key-value database' /etc/init.d/redisd
chkconfig redisd on
```

dir /var/redis/6379 设置持久化文件的存储位置
