---
layout: post
title: "Docker"
date: 2016-06-12
tags: docker
---

## Install

https://docs.docker.com/engine/install/

### CentOS

SET UP THE REPOSITORY

```bash
sudo yum install -y yum-utils

sudo yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo

```

Install Docker Engine

```bash
sudo yum install docker-ce docker-ce-cli containerd.io
```

Start Docker.

```bash
sudo systemctl start docker
```

### Debian

```bash
sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common

curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
apt-key fingerprint 0EBFCD88
sudo add-apt-repository \
   "deb [arch=amd64] https://download.docker.com/linux/debian \
   $(lsb_release -cs) \
   stable"
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io

cat <<EOF | sudo tee /etc/docker/daemon.json
{
    "registry-mirrors": ["http://hub-mirror.c.163.com"]
}
EOF
```

## Commands

## Nginx

https://hub.docker.com/_/nginx

```bash
[root@xx /]# docker run -d --name nginx \
    -p 80:80 \
    -p 443:443 \
    -v /data/www:/data/www/:ro \
    -v /data/config/nginx/nginx.conf:/etc/nginx/nginx.conf:ro \
    -v /data/config/nginx/conf.d/:/etc/nginx/conf.d:ro \
    -v /data/logs/nginx/:/var/log/nginx:rw \
    -v /etc/letsencrypt/:/etc/letsencrypt/:ro \
    nginx:stable-alpine
# 重启
[root@xx /]# docker exec nginx nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
[root@xx /]# docker exec nginx nginx -s reload
# 查看日志
[root@xx /]# docker logs nginx
# 删除容器
[root@xx /]# docker rm nginx
```


```bash
# build
docker build -t nodedemo --build-arg DOCKER_NODE_VERSION=13 .
# start
docker run -v "$PWD":/data -p 8080:8080 nodedemo npm run dev
# sh
docker run -it --rm -v "$PWD":/data -p 8000:8000 -p 8080:8080 --network docker-php_frontend nodet sh
docker build -t nodet --no-cache --build-arg DOCKER_NODE_VERSION=13 .

docker run -d --name="openresty" -p 80:80
-v /data/Gateway/etc/nginx/conf/nginx.conf:/usr/local/openresty/nginx/conf/nginx.conf:ro
-v /data/Gateway/Work/opt/local/openresty/conf.d:/etc/nginx/conf.d
-v /data/Gateway/data/opt/local/openresty/logs:/usr/local/openresty/nginx/logs
-v /data/Gateway/Work/opt/local/openresty/html:/etc/nginx/html
openresty/openresty:centos

```
